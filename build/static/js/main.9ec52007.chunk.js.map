{"version":3,"sources":["assets/logo.svg","utils/api-utils.tsx","components/Signin.tsx","components/DashboardCharts.tsx","components/AlgorithmController.tsx","components/DashboardTable.tsx","components/DashboardMain.tsx","components/UploadController.tsx","components/UploadSession.tsx","components/Dashboard.tsx","components/UploadPortal.tsx","components/Logo.tsx","components/TopBar.tsx","components/App.tsx","serviceWorker.ts","index.tsx"],"names":["module","exports","parseCookies","key","match","document","cookie","RegExp","result","decodeURIComponent","error","console","warn","queryString","params","Object","keys","map","encodeURIComponent","join","post","url","requestData","a","header","fetch","method","headers","body","then","response","json","responseData","code","log","get","undefined","handleError","errorCode","language","messageLanguageMap","message","ProductsInfo","productId","productName","productDescription","Map","Signin","onFinish","values","signinData","name","username","password","APIUtils","JSON","stringify","props","handleSignin","className","initialValues","remember","this","Item","rules","required","prefix","UserOutlined","placeholder","LockOutlined","type","valuePropName","noStyle","href","onClick","e","preventDefault","htmlType","React","Component","DashboardCharts","gutter","span","Option","Select","AlgorithmController","handleSelectAlgo","value","selectedAlgo","state","algorithmList","find","algo","algo_name","setState","selectedAlgoId","id","handleStartAnalyze","requestBody","upload_id","targetFileId","algo_id","algorithmControl","handleCancel","enzh","english","chinese","requestParams","data","items","title","visible","centered","onCancel","footer","style","margin","onChange","Search","Input","RangePicker","DatePicker","DashboardTable","timeRange","on","getFileList","product","tab","uploadList","forEach","uploadItem","fileList","filteredFileList","refresh","onSearch","filter","record","upload_name","includes","handleSelectFile","fileName","selectedFile","file","file_name","selectTimeRange","applyTimeRange","moment","unix","created_at","isBetween","algoList","prevProps","prevState","uploadInProgress","bulkActionMenu","filterPopup","showTime","format","ranges","startOf","allowClear","disabledDate","current","endOf","onOk","formColumns","dataIndex","render","text","Date","toString","split","splice","color","shape","icon","CloudUploadOutlined","drawerControl","overlay","trigger","UnorderedListOutlined","placement","content","FilterOutlined","size","width","padding","ReloadOutlined","rowSelection","pagination","pageSize","columns","dataSource","DashboardMain","zhtab","ghost","tags","subTitle","slice","length","extra","ExportOutlined","dot","BellOutlined","column","paddingTop","label","userInfo","remark","orientation","Step","Steps","UploadController","componentDidMount","modalVisible","getFileMD5","fileMD5","fileKey","file_info","file_key","file_size","uploadName","err","awsMetaData","s3Client","getS3Client","authorization","step","progress","uploadFile","md5Hash","Promise","resolve","reject","blobSlice","File","prototype","chunks","Math","ceil","currentChunk","spark","SparkMD5","ArrayBuffer","fileReader","FileReader","loadNext","start","end","readAsArrayBuffer","call","onload","append","target","parseFloat","toFixed","onerror","onabort","cognitoIdentityCredentials","credentials","AWS","CognitoIdentityCredentials","IdentityPoolId","identity_pool_id","IdentityId","identity_id","Logins","token","config","update","region","S3","apiVersion","maxRetries","httpOptions","connectTimeout","timeout","uploadConfig","Key","Bucket","bucket","UploadId","remote_upload_id","uploadPart","parts","fullPartInfo","assign","asyncS3Fetch","completeUpload","s3","fileId","partInfo","i","push","PartNumber","ETag","Body","Uint8Array","recordPart","partNumber","partETag","partSize","part_number","part_etag","part_size","uploadId","etag","location","functionName","stepDescription","currentStep","handleClose","uploadControl","direction","percent","status","description","TextArea","confirm","Modal","UploadSession","formItemLayout","inputUploadName","selectService","serviceType","setAccident","checked","isAccident","onSubmit","service","loadFile","fileData","Array","isArray","formRef","createRef","unfinishedUpload","unfinishedUploadName","labelCol","wrapperCol","ExclamationCircleOutlined","okText","cancelText","uploadTagOptions","drawerVisible","onClose","destroyOnClose","bodyStyle","paddingBottom","textAlign","marginRight","validateFields","catch","errorInfo","disabled","ref","rows","initialValue","mode","checkedChildren","unCheckedChildren","isAfter","getValueFromEvent","Dragger","beforeUpload","InboxOutlined","offset","Content","Layout","Sider","Footer","Dashboard","handleSelect","event","defaultSelectedKeys","onSelect","height","SisternodeOutlined","NodeIndexOutlined","ExperimentOutlined","minHeight","UploadPortal","resumeUploadControl","loading","Logo","src","logo","alt","Header","SubMenu","Menu","TopBar","handleSelectLanguage","switchLanguage","handleClickLogout","handleSignout","userMenu","LogoutOutlined","float","theme","authorized","GlobalOutlined","App","inputLanguage","mountSignin","to","mountDashboard","mountUploadPortal","bind","exact","path","Boolean","window","hostname","ReactDOM","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.9ec52007.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.ee7cd8ed.svg\";","import { message } from 'antd';\r\n\r\n/**\r\n * Type Definitions for HTTP request header and response data.\r\n */\r\ntype HeaderType = {\r\n  'X-CSRFToken': string;\r\n  'Content-Type': string;\r\n}\r\n\r\nexport type SuccessResponseDataType = {\r\n  code: string;\r\n  data: any;\r\n}\r\n\r\nexport type ErrorResponseDataType = {\r\n  code: string;\r\n  error: string;\r\n}\r\n\r\ntype ResponseDataType = SuccessResponseDataType | ErrorResponseDataType;\r\ninterface ParamsType { [key: string]: string | number };\r\n\r\n/**\r\n * The only hard coded CSRF token, the rest should be extracted from cookies using parseCookies('csrf_token') after logging in\r\n */\r\nconst LOGIN_CSRFToken: string = \"ImI0M2ZlZjgxZmRiNTAwZWMxYmE4NDYzYjQzNTM1MDFmZTk5OWRjOGEi.Xyw2Iw.xYuZelp39q-HpjGf_abdtEdT-Ag\";\r\n\r\n/**\r\n * Utility function to get specific info from cookies\r\n * @param key : 'csrf_token' | 'session'\r\n * @returns : string - section of cookie\r\n */\r\nconst parseCookies = (key: string): string => {\r\n  let match = document.cookie.match(new RegExp('(^| )' + key + '=([^;]+)'));\r\n  if (match) {\r\n    let result = \"\";\r\n    try {\r\n      result = decodeURIComponent(match[2]);\r\n    } catch (error) {\r\n      console.warn(\"Cookie parse error: \", error);\r\n    }\r\n    return result;\r\n  };\r\n  return \"\";\r\n}\r\n\r\n/**\r\n * Generate query string from parameters object for GET request URL\r\n * @param params : { [key: string]: string | number } - parameters object\r\n */\r\nconst queryString = (params: ParamsType): string =>\r\n  Object.keys(params).map((key: string): string =>\r\n    encodeURIComponent(key) + '=' + encodeURIComponent(params[key])\r\n  ).join('&');\r\n\r\n/**\r\n * POST HTTP Request API\r\n * @param url : string - rooted at proxy in package.json, start with \r\n * @param requestData : string - JSON string, e.g. JSON.stringify(rawData)\r\n * @returns : Promise<ResponseDataType> - Promise resolves to JSON respond body\r\n */\r\nexport const post = async (url: string, requestData?: string): Promise<ResponseDataType> => {\r\n\r\n  let header: HeaderType = {\r\n    'X-CSRFToken': (url === '/api/account/login') ? LOGIN_CSRFToken : parseCookies('csrf_token'),\r\n    'Content-Type': 'application/json'\r\n  }\r\n\r\n  return fetch(url, {\r\n    method: 'POST',\r\n    headers: header,\r\n    body: requestData\r\n  })\r\n    .then((response: Response): Promise<any> => response.json())\r\n    .then((responseData: ResponseDataType) => {\r\n      if (responseData.code === 'OK') {\r\n        console.log('SUCCESS!', url, header, requestData, responseData);\r\n      } else {\r\n        console.warn('FAIL!', url, header, requestData, responseData);\r\n      }\r\n      return responseData;\r\n    });\r\n}\r\n\r\n/**\r\n * GET HTTP Request API\r\n * @param url : string - rooted at proxy in package.json, start with \"/\"\r\n * @returns : Promise<ResponseDataType> - Promise resolves to JSON respond body\r\n */\r\nexport const get = async (url: string, params?: ParamsType): Promise<ResponseDataType> => {\r\n\r\n  if (params !== undefined) {\r\n    url = url + '?' + queryString(params);\r\n  }\r\n\r\n  return fetch(url, {\r\n    method: 'GET'\r\n  })\r\n    .then((response: Response): Promise<any> => response.json())\r\n    .then((responseData: ResponseDataType) => {\r\n      if (responseData.code === 'OK') {\r\n        console.log('SUCCESS!', url, responseData);\r\n      } else {\r\n        console.warn('FAIL!', url, responseData);\r\n      }\r\n      return responseData;\r\n    });\r\n}\r\n\r\n/**\r\n * Utility function to handle different error\r\n */\r\nexport const handleError = (errorCode: string, language: 'en-us' | 'zh-hans') => {\r\n\r\n  if (messageLanguageMap.get(errorCode) === undefined) {\r\n    message.error(messageLanguageMap.get(\"default\") + errorCode)\r\n    return;\r\n  }\r\n\r\n  if (language === 'en-us') {\r\n    message.warn(messageLanguageMap.get(errorCode)?.[\"en-us\"]);\r\n  }\r\n  else if (language === 'zh-hans') {\r\n    message.warn(messageLanguageMap.get(errorCode)?.[\"zh-hans\"]);\r\n  }\r\n}\r\n\r\n/**\r\n * Product informations defined in API\r\n */\r\ninterface ProductsInfoType {\r\n  [key: string]: {\r\n    productId: number,\r\n    productName: string,\r\n    productDescription: string\r\n  }\r\n}\r\nexport const ProductsInfo: ProductsInfoType = {\r\n  \"EV Management\": {\r\n    productId: 1,\r\n    productName: \"ev\",\r\n    productDescription: \"EV\"\r\n  },\r\n  \"ESS Management\": {\r\n    productId: 2,\r\n    productName: \"ess\",\r\n    productDescription: \"ESS\"\r\n  },\r\n  \"R&D Management\": {\r\n    productId: 3,\r\n    productName: \"rd\",\r\n    productDescription: \"RD\"\r\n  }\r\n}\r\n\r\n/**\r\n * Error messages for corresponding error codes in Engish and Chinese\r\n */\r\ntype LanguageMapType = Map<string, { \"en-us\": string; \"zh-hans\": string }>;\r\nexport const messageLanguageMap: LanguageMapType = new Map([\r\n  [\"User Not Exist\",\r\n    {\r\n      \"en-us\": \"The credential you provided does not match our record. Please try again. \",\r\n      \"zh-hans\": \"您所提供的登录信息有误，请重试。\"\r\n    }\r\n  ],\r\n  [\r\n    \"Password Error\",\r\n    {\r\n      \"en-us\": \"The credential you provided does not match our record. Please try again. \",\r\n      \"zh-hans\": \"您所提供的登录信息有误，请重试。\"\r\n    }\r\n  ],\r\n  [\r\n    \"Login Required\",\r\n    {\r\n      \"en-us\": \"Login is required for this operation.\",\r\n      \"zh-hans\": \"此操作需要登录权限，请登录。\"\r\n    }\r\n  ],\r\n  [\r\n    \"Product Not Allow\",\r\n    {\r\n      \"en-us\": \"Product permission denied. Please contact administrator. \",\r\n      \"zh-hans\": \"您暂时没有使用此服务的权限，请联系管理员。\"\r\n    }\r\n  ],\r\n  [\r\n    \"Internal Server Error\",\r\n    {\r\n      \"en-us\": \"Internal Server Error. Please contact administrator. \",\r\n      \"zh-hans\": \"系统内部错误，请联系管理员。\"\r\n    }\r\n  ],\r\n  [\r\n    \"External Error\",\r\n    {\r\n      \"en-us\": \"External Error. Please contact administrator. \",\r\n      \"zh-hans\": \"系统外部错误，请联系管理员。\"\r\n    }\r\n  ],\r\n  [\r\n    \"Method Not Allowed\",\r\n    {\r\n      \"en-us\": \"HTTP method Error. Please contact administrator. \",\r\n      \"zh-hans\": \"无效的HTTP请求，请联系管理员。\"\r\n    }\r\n  ],\r\n  [\r\n    \"defualt\",\r\n    {\r\n      \"en-us\": \"An unkown error has occured, CODE: \",\r\n      \"zh-hans\": \"未知错误，错误码：\"\r\n    }\r\n  ]\r\n])\r\n","import React from 'react';\r\n\r\nimport { Form, Input, Button, Checkbox } from 'antd';\r\nimport { UserOutlined, LockOutlined } from '@ant-design/icons';\r\n\r\nimport 'styles/signin.css';\r\n\r\nimport * as APIUtils from 'utils/api-utils';\r\n\r\ntype PropsType = {\r\n  handleSignin: () => void;\r\n  language: 'en-us' | 'zh-hans';\r\n}\r\n\r\nclass Signin extends React.Component<PropsType> {\r\n\r\n  onFinish = (values: any) => {\r\n    let signinData = {\r\n      name: values.username,\r\n      password: values.password\r\n    }\r\n\r\n    APIUtils.post('/api/account/login', JSON.stringify(signinData))\r\n      .then(response => {\r\n        if (response.code === 'OK') {\r\n          this.props.handleSignin();\r\n        } else {\r\n          APIUtils.handleError(response.code, this.props.language);\r\n        }\r\n      })\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"Signin\">\r\n        <Form\r\n          name=\"normal_login\"\r\n          className=\"login-form\"\r\n          initialValues={{ remember: true }}\r\n          onFinish={this.onFinish}\r\n        >\r\n          <Form.Item\r\n            name=\"username\"\r\n            rules={[{\r\n              required: true,\r\n              message: this.props.language === 'en-us' ?\r\n                \"Please input your name\" :\r\n                \"请输入用户名\"\r\n            }]}\r\n          >\r\n            <Input\r\n              prefix={<UserOutlined className=\"site-form-item-icon\" />}\r\n              placeholder={\r\n                this.props.language === 'en-us' ?\r\n                  \"Name\" : \"用户名\"\r\n              }\r\n            />\r\n          </Form.Item>\r\n          <Form.Item\r\n            name=\"password\"\r\n            rules={[{\r\n              required: true,\r\n              message: this.props.language === 'en-us' ?\r\n                \"Please input your Password\" :\r\n                \"请输入登录口令\"\r\n            }]}\r\n          >\r\n            <Input\r\n              prefix={<LockOutlined className=\"site-form-item-icon\" />}\r\n              type=\"password\"\r\n              placeholder={\r\n                this.props.language === 'en-us' ?\r\n                  \"Password\" : \"登录口令\"\r\n              }\r\n            />\r\n          </Form.Item>\r\n          <Form.Item>\r\n            <Form.Item name=\"remember\" valuePropName=\"unchecked\" noStyle>\r\n              <Checkbox>\r\n                {this.props.language === 'en-us' ? 'Remember me' : '保存登录信息'}\r\n              </Checkbox>\r\n            </Form.Item>\r\n            <a href=\"/\" onClick={e => e.preventDefault()} className=\"login-form-portal\">\r\n              {this.props.language === 'en-us' ? 'Administartor Portal' : '管理员通道'}\r\n            </a>\r\n          </Form.Item>\r\n\r\n          <Form.Item>\r\n            <Button type=\"primary\" htmlType=\"submit\" className=\"login-form-button\">\r\n              {this.props.language === 'en-us' ? \"Log in\" : \"登录\"}\r\n            </Button>\r\n          </Form.Item>\r\n        </Form>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Signin;\r\n","import React from 'react';\r\nimport { Row, Col } from 'antd';\r\n\r\nimport 'styles/dashboardCharts.css';\r\n\r\nclass DashboardCharts extends React.Component {\r\n  render() {\r\n    return (\r\n      <div className=\"DashboardCharts\">\r\n        <Row gutter={16}>\r\n          <Col className=\"gutter-row\" span={6}>\r\n            <div className=\"chart-box\">\r\n              <p className=\"placeholder\">&lt;Result Data&gt;</p>\r\n            </div>\r\n          </Col>\r\n          <Col className=\"gutter-row\" span={6}>\r\n            <div className=\"chart-box\">\r\n              <p className=\"placeholder\">&lt;Result Data&gt;</p>\r\n            </div>\r\n          </Col>\r\n          <Col className=\"gutter-row\" span={6}>\r\n            <div className=\"chart-box\">\r\n              <p className=\"placeholder\">&lt;Result Data&gt;</p>\r\n            </div>\r\n          </Col>\r\n          <Col className=\"gutter-row\" span={6}>\r\n            <div className=\"chart-box\">\r\n              <p className=\"placeholder\">&lt;Result Data&gt;</p>\r\n            </div>\r\n          </Col>\r\n        </Row>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DashboardCharts;\r\n","import React from 'react';\r\nimport {\r\n  message,\r\n  Modal,\r\n  Button,\r\n  Select\r\n} from 'antd';\r\n\r\nimport * as APIUtils from 'utils/api-utils';\r\n\r\nconst { Option } = Select;\r\n\r\ntype PropsType = {\r\n  targetFileId: string;\r\n  algorithmControl: (on: boolean) => void;\r\n  language: 'en-us' | 'zh-hans';\r\n}\r\n\r\ntype StateType = {\r\n  algorithmList: any[];\r\n  selectedAlgoId: string;\r\n}\r\n\r\nclass AlgorithmController extends React.Component<PropsType, StateType> {\r\n  constructor(props: PropsType) {\r\n    super(props);\r\n    this.state = {\r\n      algorithmList: [],\r\n      selectedAlgoId: \"\"\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    let requestParams = {\r\n      upload_id: this.props.targetFileId\r\n    }\r\n    APIUtils.get('/api/data/algorithm/list', requestParams)\r\n      .then(response => {\r\n        if (response.code === 'OK') {\r\n          this.setState({\r\n            algorithmList: (response as APIUtils.SuccessResponseDataType).data.items\r\n          });\r\n        } else {\r\n          APIUtils.handleError(response.code, this.props.language);\r\n        }\r\n      });\r\n  }\r\n\r\n  handleSelectAlgo = (value: string) => {\r\n    let selectedAlgo = this.state.algorithmList.find(algo => algo.algo_name === value);\r\n    if (selectedAlgo === undefined) {\r\n      console.warn(\"Cannot find \", value, \"in\", this.state.algorithmList)\r\n      return;\r\n    }\r\n    this.setState({\r\n      selectedAlgoId: selectedAlgo.id\r\n    })\r\n    console.log(\"Algorithm selected\", selectedAlgo.id);\r\n  }\r\n\r\n  handleStartAnalyze = () => {\r\n    if (this.state.selectedAlgoId === \"\") {\r\n      message.warn(\"Please select an algorithm!\");\r\n      return;\r\n    }\r\n    let requestBody = {\r\n      upload_id: this.props.targetFileId,\r\n      algo_id: this.state.selectedAlgoId\r\n    }\r\n    APIUtils.post('/api/data/analysis/start', JSON.stringify(requestBody))\r\n    .then(response => {\r\n      if (response.code !== 'OK') {\r\n        APIUtils.handleError(response.code, this.props.language);\r\n      }\r\n      this.props.algorithmControl(false);\r\n    })\r\n  }\r\n\r\n  handleCancel = () => {\r\n    this.props.algorithmControl(false);\r\n  }\r\n\r\n  enzh = (english: string, chinese: string): string =>\r\n    this.props.language === 'en-us' ? english : chinese;\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"AlgorithmController\">\r\n        <Modal\r\n          title={this.enzh(\"Select Algorithm\", \"算法选择\")}\r\n          visible={true}\r\n          centered\r\n          onCancel={this.handleCancel}\r\n          footer={[\r\n            <Button key=\"back\" onClick={this.handleCancel}>\r\n              {this.enzh(\"Cancel\", \"取消\")}\r\n            </Button>,\r\n            <Button key=\"submit\" type=\"primary\" onClick={this.handleStartAnalyze}>\r\n              {this.enzh(\"Start Analyzing\", \"开始分析\")}\r\n            </Button>,\r\n          ]}\r\n        >\r\n          <Select\r\n            placeholder={this.enzh(\"Please select an Algorithm\", \"请选择算法\")}\r\n            style={{ margin: \"auto\" }}\r\n            onChange={this.handleSelectAlgo}\r\n          >\r\n            {this.state.algorithmList.map((algo =>\r\n              (<Option key={algo.algo_name} value={algo.algo_name}>{algo.algo_name}</Option>)))}\r\n          </Select>\r\n        </Modal>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default AlgorithmController;","import React from 'react';\r\nimport moment from 'moment';\r\nimport {\r\n  Button,\r\n  Table,\r\n  Tag,\r\n  Input,\r\n  Popover,\r\n  Dropdown,\r\n  Menu,\r\n  DatePicker,\r\n} from 'antd';\r\n\r\nimport {\r\n  CloudUploadOutlined,\r\n  UnorderedListOutlined,\r\n  FilterOutlined,\r\n  ReloadOutlined\r\n} from '@ant-design/icons';\r\n\r\nimport 'styles/dashboardTable.css';\r\n\r\nimport AlgorithmController from 'components/AlgorithmController';\r\n\r\nimport * as APIUtils from 'utils/api-utils';\r\n\r\nconst { Search } = Input;\r\nconst { RangePicker } = DatePicker;\r\n\r\ntype PropsType = {\r\n  tab: string;\r\n  uploadInProgress: boolean;\r\n  drawerControl: (on: boolean) => void;\r\n  language: 'en-us' | 'zh-hans';\r\n}\r\n\r\ntype StateType = {\r\n  fileList: any[];\r\n  filteredFileList: any[];\r\n  algoList: any[];\r\n  algorithmControl: boolean;\r\n  refresh: boolean;\r\n}\r\n\r\ntype TimeRangeType = [moment.Moment, moment.Moment]\r\n\r\nclass DashboardTable extends React.Component<PropsType, StateType> {\r\n\r\n  state: StateType;\r\n  targetFileId: string;\r\n  timeRange: TimeRangeType;\r\n\r\n  constructor(props: PropsType) {\r\n    super(props);\r\n    this.state = {\r\n      fileList: [],\r\n      filteredFileList: [],\r\n      algoList: [],\r\n      algorithmControl: false,\r\n      refresh: false\r\n    }\r\n\r\n    this.targetFileId = \"\";\r\n    this.timeRange = [moment(0), moment(0)];\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getFileList();\r\n  }\r\n\r\n  componentDidUpdate(prevProps: PropsType, prevState: StateType) {\r\n    if (this.props.tab !== prevProps.tab ||\r\n      this.props.uploadInProgress !== prevProps.uploadInProgress ||\r\n      this.state.refresh !== prevState.refresh ||\r\n      this.state.algorithmControl !== prevState.algorithmControl\r\n    ) {\r\n      this.getFileList();\r\n    }\r\n  }\r\n\r\n  algorithmControl = (on: boolean) => this.setState({ algorithmControl: on });\r\n\r\n  getFileList = () => {\r\n    let requestParams = {\r\n      product: APIUtils.ProductsInfo[this.props.tab].productName\r\n    }\r\n\r\n    APIUtils.get('/api/data/upload/list', requestParams)\r\n      .then(response => {\r\n        if (response.code === 'OK') {\r\n          // assign a unique key for each row of the table\r\n          let uploadList: any[] = (response as APIUtils.SuccessResponseDataType).data.items;\r\n          uploadList.forEach((uploadItem: any) => {\r\n            uploadItem.key = uploadItem.id;\r\n          });\r\n          this.setState({\r\n            fileList: uploadList,\r\n            filteredFileList: uploadList\r\n          })\r\n        } else {\r\n          APIUtils.handleError(response.code, this.props.language);\r\n        }\r\n      })\r\n  }\r\n\r\n  refresh = () => {\r\n    this.setState((state, props) => ({\r\n      refresh: !state.refresh\r\n    }));\r\n  }\r\n\r\n  onSearch = (value: string) => {\r\n    if (value === \"\") {\r\n      this.setState({\r\n        filteredFileList: this.state.fileList\r\n      })\r\n    }\r\n    this.setState(state => ({\r\n      filteredFileList: state.filteredFileList.filter(record => record.upload_name.includes(value))\r\n    }));\r\n  }\r\n\r\n  handleSelectFile = (e: any, fileName: string) => {\r\n    e.preventDefault();\r\n    let selectedFile = this.state.fileList.find(file => file.file_name === fileName);\r\n    if (selectedFile === undefined) {\r\n      console.warn(\"Cannot find \", fileName, \"in\", this.state.fileList);\r\n      return;\r\n    }\r\n    this.targetFileId = selectedFile.id;\r\n    console.log(\"File selected\", this.targetFileId)\r\n    this.setState({\r\n      algorithmControl: true\r\n    })\r\n  }\r\n\r\n  selectTimeRange = (value: any) => {\r\n    this.timeRange = value;\r\n  }\r\n\r\n  applyTimeRange = () => {\r\n    console.log(\"Time range selected: \", this.timeRange);\r\n    this.setState(state => ({\r\n      filteredFileList: state.filteredFileList.filter(record =>\r\n        moment.unix(record.created_at).isBetween(this.timeRange[0], this.timeRange[1]))\r\n    }));\r\n  }\r\n\r\n  enzh = (english: string, chinese: string): string =>\r\n    this.props.language === 'en-us' ? english : chinese;\r\n\r\n  render() {\r\n\r\n    let bulkActionMenu = (\r\n      <Menu>\r\n        <Menu.Item key=\"bulk-choose-algo\">{this.enzh(\"Choose Algorithm\", \"选择算法\")}</Menu.Item>\r\n        <Menu.Item key=\"bulk-view-result\">{this.enzh(\"View Result\", \"查看结果\")}</Menu.Item>\r\n      </Menu>\r\n    )\r\n\r\n    let filterPopup = (\r\n      <div>\r\n        <RangePicker\r\n          showTime={{ format: 'HH:mm' }}\r\n          format=\"YYYY-MM-DD HH:mm\"\r\n          ranges={{\r\n            'Today': [moment(), moment()],\r\n            'This Month': [moment().startOf('month'), moment()],\r\n            'This Year': [moment().startOf('year'), moment()]\r\n          }}\r\n          allowClear={true}\r\n          disabledDate={(current: moment.Moment) => current > moment().endOf('day')}\r\n          onChange={this.selectTimeRange}\r\n          onOk={this.applyTimeRange}\r\n        />\r\n      </div>\r\n    )\r\n\r\n    let formColumns = [\r\n      {\r\n        title: this.enzh('File Name', '数据名'),\r\n        dataIndex: 'upload_name',\r\n        key: 'file_name',\r\n      },\r\n      {\r\n        title: this.enzh('File Key', '数据编码'),\r\n        dataIndex: 'id',\r\n        key: 'id',\r\n      },\r\n      {\r\n        title: this.enzh('Upload Time', '上传时间'),\r\n        dataIndex: 'created_at',\r\n        key: 'created_at',\r\n        render: (text: number) => {\r\n          let current = new Date(text * 1000);\r\n          return <div>{current.toString().split(' ').splice(0, 6).join(' ')}</div>\r\n        }\r\n      },\r\n      {\r\n        title: this.enzh('Status', '状态'),\r\n        dataIndex: 'state',\r\n        key: 'state',\r\n        render: (text: string) => {\r\n          switch (text) {\r\n            case 'uploaded-raw':\r\n              return (<Tag color=\"cyan\">{this.enzh(\"Uploaded\", \"上传完成\")}</Tag>);\r\n            case 'uploading':\r\n              return (<Tag color=\"orange\">{this.enzh(\"Upload Unfinished\", \"上传未完成\")}</Tag>);\r\n            default:\r\n              return (<Tag color=\"blue\">{this.enzh(\"Complete\", \"分析完成\")}</Tag>);\r\n          }\r\n        },\r\n      },\r\n      {\r\n        title: this.enzh('Action', '可选操作'),\r\n        dataIndex: '',\r\n        key: 'x',\r\n        render: (text: any, record: any) => {\r\n          if (record.state === 'uploaded-raw') {\r\n            return (<a href=\"/#\" onClick={e => { this.handleSelectFile(e, record.file_name) }}>{this.enzh(\"Select Algorithm\", \"选择算法\")}</a>);\r\n          } else if (record.state === 'uploading') {\r\n            return (<span style={{ color: \"#00000040\" }}>-</span>);\r\n          } else {\r\n            return (<a href=\"/#\" onClick={e => { e.preventDefault() }}>{this.enzh(\"View Result\", \"查看结果\")}</a>);\r\n          }\r\n        },\r\n      },\r\n    ];\r\n\r\n    return (\r\n      <div className=\"DashboardTable\">\r\n        <Button\r\n          className=\"table-button\"\r\n          type=\"primary\"\r\n          shape=\"round\"\r\n          icon={<CloudUploadOutlined />}\r\n          onClick={() => this.props.drawerControl(true)}\r\n        >\r\n          {this.enzh(\"New Upload\", \"上传数据\")}\r\n        </Button>\r\n\r\n        <Dropdown overlay={bulkActionMenu} trigger={['click']}>\r\n          <Button\r\n            className=\"table-button\"\r\n            shape=\"round\"\r\n            icon={<UnorderedListOutlined />}\r\n          >\r\n            {this.enzh(\"Bulk Action\", \"多选操作\")}\r\n        </Button>\r\n        </Dropdown>\r\n\r\n        <Popover\r\n          placement=\"bottomLeft\"\r\n          content={filterPopup}\r\n          trigger=\"click\"\r\n        >\r\n          <Button\r\n            className=\"table-button\"\r\n            shape=\"round\"\r\n            icon={<FilterOutlined />}\r\n          >\r\n            {this.enzh(\"Filter\", \"筛选\")}\r\n          </Button>\r\n        </Popover>\r\n\r\n        <Search\r\n          key={this.state.refresh.toString()}\r\n          onSearch={this.onSearch}\r\n          size=\"small\"\r\n          style={{\r\n            width: 200,\r\n            padding: \"5px\",\r\n          }}\r\n        />\r\n\r\n        <Button\r\n          className=\"table-button refresh\"\r\n          shape=\"round\"\r\n          type=\"link\"\r\n          icon={<ReloadOutlined />}\r\n          onClick={this.refresh}\r\n        >\r\n          {this.enzh(\"Refresh / Clear Filter\", \"重置\")}\r\n        </Button>\r\n\r\n        <Table\r\n          size=\"middle\"\r\n          rowSelection={{}}\r\n          pagination={{ pageSize: 7 }}\r\n          columns={formColumns}\r\n          dataSource={this.state.filteredFileList}\r\n        />\r\n        { this.state.algorithmControl ?\r\n          <AlgorithmController\r\n            targetFileId={this.targetFileId}\r\n            algorithmControl={this.algorithmControl}\r\n            language={this.props.language}\r\n          /> : null\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DashboardTable;\r\n","import React from 'react';\r\nimport {\r\n  PageHeader,\r\n  Button,\r\n  Divider,\r\n  Descriptions,\r\n  Tag,\r\n  Badge,\r\n} from 'antd';\r\nimport {\r\n  ExportOutlined,\r\n  BellOutlined\r\n} from '@ant-design/icons';\r\n\r\nimport 'styles/dashboardMain.css';\r\n\r\nimport DashboardCharts from 'components/DashboardCharts';\r\nimport DashboardTable from 'components/DashboardTable';\r\n\r\ntype PropsType = {\r\n  tab: string;\r\n  userInfo: any;\r\n  uploadInProgress: boolean;\r\n  drawerControl: (on: boolean) => void;\r\n  language: 'en-us' | 'zh-hans';\r\n}\r\n\r\nclass DashboardMain extends React.Component<PropsType> {\r\n  \r\n  enzh = (english: string, chinese: string): string =>\r\n    this.props.language === 'en-us' ? english : chinese;\r\n\r\n  zhtab = (english: string): string => {\r\n    switch (english) {\r\n      case \"EV Management\":\r\n        return \"电动汽车分析平台\";\r\n      case \"ESS Management\":\r\n        return \"储能系统分析平台\";\r\n      case \"R&D Management\":\r\n        return \"电池研发测试分析平台\";\r\n      default:\r\n        return \"\";\r\n    }\r\n  } \r\n\r\n  render() {\r\n    return (\r\n      <div className=\"DashboardMain\">\r\n        <PageHeader\r\n          ghost={false}\r\n          title={this.enzh(this.props.tab, this.zhtab(this.props.tab))}\r\n          tags={<Tag color=\"orange\">Admin</Tag>}\r\n          subTitle={\r\n            this.enzh(`Manage ${this.props.tab.split(' ')[0]} upload items`,\r\n              `管理${this.zhtab(this.props.tab).slice(0, this.zhtab(this.props.tab).length - 2)}数据`)\r\n          }\r\n          extra={[\r\n            <Button\r\n              key=\"upload-button\"\r\n              type=\"primary\"\r\n              shape=\"round\"\r\n              icon={<ExportOutlined />}\r\n            >\r\n              {this.enzh(\"Export\", \"下载结果\")}\r\n            </Button>,\r\n            <Badge dot\r\n              key=\"notification-badge\">\r\n              <Button\r\n                key=\"notification-button\"\r\n                shape=\"circle\"\r\n                icon={<BellOutlined />}\r\n              />\r\n            </Badge>\r\n          ]}\r\n          style={{\r\n            padding: '0px 5px 15px'\r\n          }}\r\n        >\r\n          <Descriptions size=\"small\" column={3} style={{ paddingTop: \"3px\" }}>\r\n            <Descriptions.Item label={this.enzh(\"Owner\", \"用户\")}>\r\n              {this.props.userInfo.name}\r\n            </Descriptions.Item>\r\n            <Descriptions.Item label={this.enzh(\"Affiliation\", \"编号\")}>\r\n              {this.props.userInfo.id}\r\n            </Descriptions.Item>\r\n            <Descriptions.Item label={this.enzh(\"Remarks\", \"备注\")}>\r\n              {this.props.userInfo.remark}\r\n            </Descriptions.Item>\r\n          </Descriptions>\r\n        </PageHeader>\r\n        <DashboardCharts />\r\n        <Divider orientation=\"left\">{this.enzh(\"Manage Uploads\", \"项目管理\")}</Divider>\r\n        <DashboardTable\r\n          tab={this.props.tab}\r\n          uploadInProgress={this.props.uploadInProgress}\r\n          drawerControl={this.props.drawerControl}\r\n          language={this.props.language}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DashboardMain;\r\n","import React from 'react';\r\nimport AWS from 'aws-sdk';\r\nimport SparkMD5 from 'spark-md5';\r\nimport { Modal, Steps } from 'antd';\r\n\r\nimport * as APIUtils from 'utils/api-utils';\r\n\r\nconst { Step } = Steps;\r\n\r\ntype PropsType = {\r\n  file: File;\r\n  uploadName: string;\r\n  product: string;\r\n  uploadControl: (on: boolean) => void;\r\n  language: 'en-us' | 'zh-hans';\r\n}\r\n\r\ntype StateType = {\r\n  modalVisible: boolean;\r\n  step: number;\r\n  progress: number;\r\n  err: boolean;\r\n}\r\n\r\nclass UploadController extends React.Component<PropsType, StateType> {\r\n\r\n  constructor(props: PropsType) {\r\n    super(props);\r\n    this.state = {\r\n      modalVisible: false,\r\n      step: 0,\r\n      progress: 0,\r\n      err: false\r\n    };\r\n  }\r\n\r\n  componentDidMount = () => {\r\n    let file = this.props.file;\r\n    console.log(\"File recieved\", file)\r\n\r\n    this.setState({\r\n      modalVisible: true\r\n    });\r\n\r\n    this.getFileMD5(file).then(fileMD5 => {\r\n      let fileKey = fileMD5;\r\n      console.log(\"MD5 hash complete\", fileMD5)\r\n      let file_info = {\r\n        file_key: fileKey,\r\n        file_name: file.name,\r\n        file_size: file.size,\r\n        upload_name: this.props.uploadName,\r\n        product: this.props.product\r\n      }\r\n\r\n      APIUtils.post('/api/data/multipart_upload/init', JSON.stringify(file_info))\r\n        .then(response => {\r\n          if (response.code !== 'OK') {\r\n            this.setState({\r\n              err: true\r\n            })\r\n            APIUtils.handleError(response.code, this.props.language);\r\n          } \r\n          else {\r\n            let awsMetaData = (response as APIUtils.SuccessResponseDataType).data;\r\n            console.log(\"AWS metadata acquired\", awsMetaData)\r\n\r\n            let s3Client = this.getS3Client(awsMetaData.authorization);\r\n\r\n            this.setState({\r\n              step: 1,\r\n              progress: 0\r\n            });\r\n\r\n            try {\r\n              this.uploadFile(s3Client, awsMetaData, file, fileMD5)\r\n            } catch (err) {\r\n              this.setState({ err: true });\r\n              console.warn(err);\r\n            }\r\n          }\r\n        });\r\n    });\r\n  }\r\n\r\n  getFileMD5 = async (file: File) => {\r\n    try {\r\n      return await this.md5Hash(file);\r\n    } catch (err) {\r\n      this.setState({ err: true });\r\n      console.log(err);\r\n    }\r\n  }\r\n\r\n  md5Hash = (file: File) => {\r\n    return new Promise((resolve, reject) => {\r\n      var blobSlice = File.prototype.slice,\r\n        chunkSize = 5 * 1024 * 1024,\r\n        chunks = Math.ceil(file.size / chunkSize),\r\n        currentChunk = 0,\r\n        spark = new SparkMD5.ArrayBuffer(),\r\n        fileReader = new FileReader();\r\n\r\n      fileReader.onload = (e: any) => {\r\n        spark.append(e.target.result);\r\n        currentChunk++;\r\n\r\n        this.setState({\r\n          progress: parseFloat((currentChunk / chunks * 100).toFixed(2))\r\n        })\r\n\r\n        if (currentChunk < chunks) {\r\n          loadNext();\r\n        } else {\r\n          console.log('finished loading');\r\n          resolve(spark.end());\r\n        }\r\n      };\r\n\r\n      fileReader.onerror = () => {\r\n        this.setState({ err: true });\r\n        console.warn('oops, something went wrong.');\r\n      };\r\n\r\n      fileReader.onabort = () => {\r\n        console.warn('abort.');\r\n      };\r\n\r\n      function loadNext() {\r\n        let start = currentChunk * chunkSize,\r\n          end = ((start + chunkSize) >= file.size) ? file.size : start + chunkSize;\r\n        fileReader.readAsArrayBuffer(blobSlice.call(file, start, end));\r\n      }\r\n      loadNext();\r\n    })\r\n  }\r\n\r\n  getS3Client = (cognitoIdentityCredentials: any) => {\r\n    // var identity_provider = cognitoIdentityCredentials.identity_provider;\r\n    let credentials = new AWS.CognitoIdentityCredentials({\r\n      IdentityPoolId: cognitoIdentityCredentials.identity_pool_id,\r\n      IdentityId: cognitoIdentityCredentials.identity_id,\r\n      Logins: {\r\n        // identity_provider: cognitoIdentityCredentials.token\r\n        'cognito-identity.amazonaws.com': cognitoIdentityCredentials.token\r\n      },\r\n    })\r\n\r\n    AWS.config.update({\r\n      credentials: credentials,\r\n      region: cognitoIdentityCredentials.region,\r\n    })\r\n\r\n    let s3 = new AWS.S3({\r\n      apiVersion: '2006-03-01',\r\n      maxRetries: 3,\r\n      httpOptions: {\r\n        connectTimeout: 1000 * 10,\r\n        timeout: 1000 * 60 * 10,\r\n      }\r\n    });\r\n\r\n    return s3;\r\n  }\r\n\r\n  uploadFile = async (s3Client: any, awsMetaData: any, file: any, fileKey: any) => {\r\n    let uploadConfig = {\r\n      Key: fileKey,\r\n      Bucket: awsMetaData.bucket,\r\n      UploadId: awsMetaData.remote_upload_id\r\n    }\r\n\r\n    console.log(\"Upload configuration generated\", uploadConfig);\r\n\r\n    let fullPartInfo = await this.uploadPart(s3Client, uploadConfig, awsMetaData.id, file, awsMetaData.parts);\r\n    console.log(\"Full part infomation generated\", fullPartInfo);\r\n    let params = Object.assign({ 'MultipartUpload': fullPartInfo }, uploadConfig);\r\n    console.log(\"Params genterated\", params);\r\n    let result = await this.asyncS3Fetch(s3Client, 'completeMultipartUpload', params);\r\n    console.log(\"Result params returned\", result);\r\n    this.completeUpload(awsMetaData.id, fileKey, result['ETag'], result['Location']);\r\n  }\r\n\r\n  uploadPart = async (s3: any, config: any, fileId: any, file: any, parts: any) => {\r\n    return new Promise((resolve, reject) => {\r\n\r\n      var blobSlice = File.prototype.slice,\r\n        chunkSize = 5 * 1024 * 1024,\r\n        chunks = Math.ceil(file.size / chunkSize),\r\n        currentChunk = parts.length > 0 ? parts[parts.length - 1]['part_number'] : 0,\r\n        fileReader = new FileReader(),\r\n        partInfo: any = {\r\n          'Parts': []\r\n        };\r\n\r\n      for (var i of parts) {\r\n        partInfo['Parts'].push({\r\n          PartNumber: i['part_number'],\r\n          ETag: i['etag']\r\n        })\r\n      }\r\n\r\n      fileReader.onload = async (e: any) => {\r\n\r\n        if (currentChunk < chunks) {\r\n          var params = Object.assign({\r\n            Body: new Uint8Array(e.target.result),\r\n            PartNumber: currentChunk + 1,\r\n          }, config);\r\n          let response = await this.asyncS3Fetch(s3, 'uploadPart', params);\r\n          partInfo['Parts'].push({\r\n            PartNumber: params['PartNumber'],\r\n            ETag: response.ETag\r\n          })\r\n\r\n          this.recordPart(fileId, params['PartNumber'], response.ETag, params['Body'].length);\r\n\r\n          currentChunk++;\r\n          this.setState({\r\n            progress: parseFloat((currentChunk / chunks * 100).toFixed(2))\r\n          });\r\n\r\n          loadNext();\r\n        } else {\r\n          console.log('finished loading');\r\n          resolve(partInfo)\r\n        }\r\n      };\r\n\r\n      fileReader.onerror = () => {\r\n        this.setState({ err: true });\r\n        console.warn('oops, something went wrong.');\r\n      };\r\n\r\n      fileReader.onabort = () => {\r\n        console.warn('abort.');\r\n      };\r\n\r\n      function loadNext() {\r\n        var start = currentChunk * chunkSize,\r\n          end = ((start + chunkSize) >= file.size) ? file.size : start + chunkSize;\r\n\r\n        fileReader.readAsArrayBuffer(blobSlice.call(file, start, end));\r\n      }\r\n      loadNext();\r\n    })\r\n  }\r\n\r\n  recordPart = (fileId: string, partNumber: number, partETag: string, partSize: number) => {\r\n    var requestData = {\r\n      upload_id: fileId,\r\n      part_number: partNumber,\r\n      part_etag: partETag,\r\n      part_size: partSize\r\n    }\r\n\r\n    APIUtils.post('/api/data/multipart_upload/add_part', JSON.stringify(requestData))\r\n      .then(response => {\r\n        if (response.code !== 'OK') {\r\n          this.setState({\r\n            err: true\r\n          })\r\n          APIUtils.handleError(response.code, this.props.language);\r\n        }\r\n      })\r\n  }\r\n\r\n  completeUpload = (uploadId: string, fileKey: string, etag: string, location: string) => {\r\n    let requestData = {\r\n      upload_id: uploadId,\r\n      file_key: fileKey,\r\n      etag: etag,\r\n      location: location\r\n    }\r\n\r\n    APIUtils.post('/api/data/multipart_upload/complete', JSON.stringify(requestData))\r\n      .then(response => {\r\n        if (response.code === 'OK') {\r\n          this.setState({\r\n            step: 3\r\n          });\r\n        } else {\r\n          this.setState({\r\n            err: true\r\n          })\r\n          APIUtils.handleError(response.code, this.props.language);\r\n        }\r\n      })\r\n  }\r\n\r\n  asyncS3Fetch = (s3: any, functionName: string, params: any): any => {\r\n    return new Promise((resolve, reject) => {\r\n      s3[functionName](params, (err: any, data: any) => {\r\n        if (err) {\r\n          this.setState({ err: true });\r\n          console.log('error: ', err);\r\n          resolve(err);\r\n        }\r\n        else {\r\n          console.log('data: ', data);\r\n          resolve(data);\r\n        }\r\n      })\r\n    });\r\n  }\r\n\r\n  stepDescription = (currentStep: number) => {\r\n    if (this.state.step < currentStep) {\r\n      return this.enzh(\"Waiting\", \"等待中...\");\r\n    } else if (this.state.step > currentStep) {\r\n      return this.enzh(\"Finished\", \"已完成\");\r\n    } else {\r\n      return this.enzh(\"Current Progress: \", \"当前进度：\") + this.state.progress + \"%\";\r\n    }\r\n  }\r\n\r\n  handleClose = () => {\r\n    this.setState({\r\n      modalVisible: false\r\n    });\r\n    if (this.state.step >= 2) {\r\n      this.props.uploadControl(false);\r\n    }\r\n  }\r\n\r\n  enzh = (english: string, chinese: string): string =>\r\n    this.props.language === 'en-us' ? english : chinese;\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"UploadController\">\r\n        <Modal\r\n          visible={this.state.modalVisible}\r\n          centered\r\n          title={this.enzh(\"Upload Data\", \"上传数据文件\")}\r\n          footer={null}\r\n          onCancel={this.handleClose}\r\n        >\r\n          <Steps\r\n            direction=\"vertical\"\r\n            current={this.state.step}\r\n            percent={this.state.progress}\r\n            status={this.state.err ? \"error\" : \"process\"}\r\n          >\r\n            <Step\r\n              title={this.enzh(\"Processing File\", \"处理文件\")}\r\n              description={this.stepDescription(0)}\r\n            />\r\n            <Step\r\n              title={this.enzh(\"Uploading File\", \"上传文件\")}\r\n              description={this.stepDescription(1)}\r\n            />\r\n            <Step\r\n              title={this.enzh(\"Upload Finished\", \"上传完成\")}\r\n              description={this.state.step >= 2 ? this.enzh(\"You may now close the window.\", \"您可以关闭此对话框\") : this.enzh(\"Waiting\", \"等待中...\")}\r\n            />\r\n          </Steps>\r\n        </Modal>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default UploadController;","import React from 'react';\r\nimport moment from 'moment';\r\nimport {\r\n  Drawer,\r\n  DatePicker,\r\n  Form,\r\n  Input,\r\n  Button,\r\n  Select,\r\n  Switch,\r\n  Upload,\r\n  Modal\r\n} from \"antd\";\r\nimport { FormInstance } from 'antd/lib/form';\r\nimport {\r\n  InboxOutlined,\r\n  CloudUploadOutlined,\r\n  ExclamationCircleOutlined\r\n} from \"@ant-design/icons\";\r\n\r\nimport 'styles/uploadSession.css';\r\n\r\nimport UploadController from \"components/UploadController\";\r\n\r\nimport * as APIUtils from 'utils/api-utils';\r\n\r\nconst { TextArea } = Input;\r\nconst { Option } = Select;\r\nconst { confirm } = Modal;\r\n\r\ntype PropsType = {\r\n  drawerVisible: boolean;\r\n  uploadInProgress: boolean;\r\n  drawerControl: (on: boolean) => void;\r\n  uploadControl: (on: boolean) => void;\r\n  tab: string;\r\n  language: 'en-us' | 'zh-hans';\r\n}\r\n\r\ntype StateType = {\r\n  fileData: any;\r\n  uploadName: string;\r\n  serviceType: string;\r\n  isAccident: boolean;\r\n  unfinishedUpload: boolean;\r\n  unfinishedUploadName: string;\r\n}\r\n\r\nclass UploadSession extends React.Component<PropsType, StateType> {\r\n\r\n  state: StateType;\r\n  formItemLayout: any;\r\n  constructor(props: PropsType) {\r\n    super(props);\r\n    this.state = {\r\n      fileData: null,\r\n      uploadName: \"\",\r\n      serviceType: \"ev\",\r\n      isAccident: false,\r\n      unfinishedUpload: false,\r\n      unfinishedUploadName: \"\"\r\n    };\r\n\r\n    this.formItemLayout = {\r\n      labelCol: { span: 6 },\r\n      wrapperCol: { span: 14 }\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    APIUtils.get('/api/data/upload/list', { product: this.state.serviceType })\r\n    .then(response => {\r\n      if (response.code === 'OK') {\r\n        let uploadList: any[] = (response as APIUtils.SuccessResponseDataType).data.items;\r\n        if (uploadList.length !== 0 && uploadList[0].state === 'uploading') {\r\n          this.setState({\r\n            unfinishedUpload: true,\r\n            unfinishedUploadName: (uploadList[0].upload_name)\r\n          });\r\n\r\n          confirm({\r\n            title: this.enzh(\r\n              `Unfinished upload detected: ${this.state.unfinishedUploadName}`,\r\n              `检测到尚未完成的上传: ${this.state.unfinishedUploadName}`\r\n              ),\r\n            icon: <ExclamationCircleOutlined />,\r\n            content: this.enzh(\r\n              \"If you wish to resume the unfinished upload, select the same file and upload again. \",\r\n              \"如果您想要继续未完成的上传，请在您的设备上选择该文件并再次点击上传。\"\r\n              ),\r\n            onOk() {},\r\n            onCancel() {},\r\n            okText: this.enzh(\"OK\", \"确定\"),\r\n            cancelText: this.enzh(\"Cancel\", \"取消\"),\r\n            width: 500\r\n          });\r\n        }\r\n      } else {\r\n        APIUtils.handleError(response.code, this.props.language)\r\n      }\r\n    })\r\n  }\r\n\r\n  componentDidUpdate(prevProps: PropsType) {\r\n    if (this.props.tab !== prevProps.tab) {\r\n      switch(this.props.tab) {\r\n        case \"EV Management\":\r\n          this.setState({ serviceType: \"ev\" });\r\n          break;\r\n        case \"ESS Management\":\r\n          this.setState({ serviceType: \"ess\" });\r\n          break;\r\n        case \"R&D Management\":\r\n          this.setState({ serviceType: \"rd\" });\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  inputUploadName = (e: any) => this.setState({ uploadName: e.target.value });\r\n  selectService = (value: string) => this.setState({ serviceType: value });\r\n  setAccident = (checked: boolean) => this.setState({ isAccident: checked });\r\n  onSubmit = (values: any) => {\r\n    console.log(\"Recieved values from form:\", values);\r\n    this.setState({\r\n      uploadName: values.uploadName,\r\n      serviceType: values.service\r\n    })\r\n    this.props.uploadControl(true);\r\n    this.props.drawerControl(false);\r\n  }\r\n\r\n  loadFile = (e: any) => {\r\n    this.setState({\r\n      fileData: e.file\r\n    });\r\n\r\n    if (Array.isArray(e)) {\r\n      return e;\r\n    }\r\n    return e && e.fileList;\r\n  };\r\n\r\n  formRef = React.createRef<FormInstance>();\r\n\r\n  enzh = (english: string, chinese: string): string =>\r\n    this.props.language === 'en-us' ? english : chinese;\r\n\r\n  render() {\r\n\r\n    let uploadTagOptions = [];\r\n    for (let i = 1; i <= 3; i++) {\r\n      let value = this.state.serviceType.split(' ')[0] + i;\r\n      uploadTagOptions.push(<Option key={value} value={value}>{value}</Option>)\r\n    }\r\n\r\n    return (\r\n      <div className=\"UploadSession\">\r\n        <div className=\"upload-drawer\">\r\n          <Drawer\r\n            title={this.enzh(\"Start New Upload Session\", \"上传数据\")}\r\n            width={720}\r\n            visible={this.props.drawerVisible}\r\n            onClose={() => this.props.drawerControl(false)}\r\n            destroyOnClose={true}\r\n            bodyStyle={{ paddingBottom: 80 }}\r\n            footer={\r\n              <div\r\n                style={{\r\n                  textAlign: 'left',\r\n                }}\r\n              >\r\n                <Button\r\n                  type=\"primary\"\r\n                  icon={<CloudUploadOutlined />}\r\n                  style={{ marginRight: 8 }}\r\n                  onClick={() => {\r\n                    this.formRef.current?.validateFields()\r\n                    .then(this.onSubmit)\r\n                    .catch(errorInfo => {\r\n                      console.warn(\"Form validation error: \", errorInfo);\r\n                    })\r\n                  }}\r\n                  disabled={\r\n                    !this.state.fileData || this.state.uploadName === \"\"\r\n                  }\r\n                >\r\n                  {this.enzh(\"Start Upload\", \"开始上传\")}\r\n                </Button>\r\n                <Button onClick={() => this.props.drawerControl(false)}>\r\n                  {this.enzh(\"Cancel\", \"取消\")}\r\n                </Button>\r\n              </div>\r\n            }\r\n          >\r\n\r\n            <div className=\"upload-form\">\r\n              <Form name=\"upload-form\"\r\n                {...this.formItemLayout}\r\n                ref={this.formRef}\r\n              >\r\n\r\n                <Form.Item\r\n                  label={this.enzh(\"Upload Name\", \"数据名\")}\r\n                  name=\"uploadName\"\r\n                  rules={[\r\n                    { required: true, message: this.enzh(\"An upload name is required to continue\", \"请输入数据名\") }\r\n                  ]}\r\n                >\r\n                  <Input onChange={this.inputUploadName} placeholder={this.enzh(\"Custom name for this dataset.\", \"请自定义数据名\")} />\r\n                </Form.Item>\r\n\r\n                <Form.Item label={this.enzh(\"Upload Remarks\", \"上传备注\")} name=\"note\">\r\n                  <TextArea rows={3} placeholder={this.enzh(\"Description and remarks of this dataset (Optional)\", \"\")} />\r\n                </Form.Item>\r\n\r\n                <Form.Item\r\n                  label={this.enzh(\"Select Service\", \"选择数据类型\")}\r\n                  initialValue={APIUtils.ProductsInfo[this.props.tab].productName}\r\n                  name=\"service\"\r\n                >\r\n                  <Select onChange={this.selectService}>\r\n                    <Option value=\"ev\">{this.enzh(\"EV Operation\", \"电动汽车运行数据\")}</Option>\r\n                    <Option value=\"ess\">{this.enzh(\"ESS Operation\", \"储能系统分析平台\")}</Option>\r\n                    <Option value=\"rd\">{this.enzh(\"Cell Long-term Performance Testing\", \"电芯循环测试数据\")}</Option>\r\n                  </Select>\r\n                </Form.Item>\r\n\r\n                <Form.Item label={this.enzh(\"Upload ID Tag\", \"上传标签\")} name=\"idtag\">\r\n                  <Select mode=\"tags\" style={{ width: '100%' }} placeholder={this.enzh(\"Upload Tag (Optional)\", \"\")}>\r\n                    {uploadTagOptions}\r\n                  </Select>\r\n                </Form.Item>\r\n\r\n                <Form.Item label={this.enzh(\"Accident Data\", \"添加事故数据\")} name=\"isAccident\" valuePropName=\"checked\">\r\n                  <Switch checkedChildren=\"Yes\" unCheckedChildren=\"No\" onChange={this.setAccident} />\r\n                </Form.Item>\r\n\r\n                <Form.Item label={this.enzh(\"Accident Date\", \"事故日期\")} name=\"accidentDate\">\r\n                  <DatePicker\r\n                    disabled={!this.state.isAccident}\r\n                    placeholder={this.enzh(\"Select Date\", \"选择日期\")}\r\n                    disabledDate={current => current.isAfter(moment())} />\r\n                </Form.Item>\r\n\r\n                <Form.Item label={this.enzh(\"Accident Description\", \"事故描述\")} name=\"accidentNote\">\r\n                  <TextArea\r\n                    rows={3}\r\n                    style={{ width: '100%' }}\r\n                    disabled={!this.state.isAccident}\r\n                    placeholder={this.enzh(\"Relevant infomations about this accident. (Optional)\", \"\")} />\r\n                </Form.Item>\r\n\r\n                <Form.Item\r\n                  label={this.enzh(\"Upload File\", \"上传数据\")}\r\n                  rules={[\r\n                    { required: true, message: this.enzh(\"Please upload dataset to continue. \", \"请添加数据文件\") }\r\n                  ]}\r\n                >\r\n                  <Form.Item\r\n                    name=\"dragger\"\r\n                    valuePropName=\"fileList\"\r\n                    getValueFromEvent={this.loadFile}\r\n                    noStyle\r\n                  >\r\n                    <Upload.Dragger\r\n                      name=\"files\"\r\n                      beforeUpload={(file, fileList) => false}\r\n                    >\r\n                      <p className=\"ant-upload-drag-icon\">\r\n                        <InboxOutlined />\r\n                      </p>\r\n                      <p className=\"ant-upload-text\">\r\n                        {this.enzh(\"Click or drag file to this area to upload\", \"点击或拖拽文件至此区域\")}\r\n                    </p>\r\n                    </Upload.Dragger>\r\n                  </Form.Item>\r\n                </Form.Item>\r\n\r\n                <Form.Item\r\n                  wrapperCol={{\r\n                    span: 12,\r\n                    offset: 6\r\n                  }}\r\n                >\r\n                </Form.Item>\r\n              </Form>\r\n            </div>\r\n          </Drawer>\r\n        </div>\r\n\r\n        { this.props.uploadInProgress ?\r\n          <UploadController\r\n            file={this.state.fileData}\r\n            uploadName={this.state.uploadName}\r\n            product={this.state.serviceType}\r\n            uploadControl={this.props.uploadControl}\r\n            language={this.props.language}\r\n          /> : null\r\n        }\r\n\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default UploadSession;","import React from 'react';\r\n\r\nimport { Layout, Menu, Breadcrumb, } from 'antd';\r\nimport {\r\n  SisternodeOutlined,\r\n  ExperimentOutlined,\r\n  NodeIndexOutlined\r\n} from '@ant-design/icons';\r\n\r\nimport 'styles/dashboard.css';\r\n\r\nimport DashboardMain from 'components/DashboardMain';\r\nimport UploadSession from 'components/UploadSession';\r\n\r\nimport * as APIUtils from 'utils/api-utils';\r\n\r\n// const { SubMenu } = Menu;\r\nconst { Content, Sider, Footer } = Layout;\r\n\r\ntype PropsType = {\r\n  language: 'en-us' | 'zh-hans';\r\n}\r\n\r\ntype StateType = {\r\n  userInfo: any;\r\n  tab: string;\r\n  drawerVisible: boolean;\r\n  uploadInProgress: boolean;\r\n}\r\n\r\nclass Dashboard extends React.Component<PropsType, StateType> {\r\n\r\n  state: StateType;\r\n\r\n  constructor(props: PropsType) {\r\n    super(props);\r\n    this.state = {\r\n      userInfo: {\r\n        name: '-',\r\n        id: '-',\r\n        remark: '-'\r\n      },\r\n      tab: 'EV Management',\r\n      drawerVisible: false,\r\n      uploadInProgress: false\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Log userInfo into state\r\n   */\r\n  componentDidMount() {\r\n    APIUtils.get('/api/account/user/info')\r\n    .then(response => {\r\n      if (response.code === 'OK') {\r\n        this.setState({\r\n          userInfo: (response as APIUtils.SuccessResponseDataType).data,\r\n        })\r\n      } else {\r\n        APIUtils.handleError(response.code, this.props.language);\r\n      }\r\n    })\r\n  }\r\n\r\n  // controller methods\r\n  handleSelect = (event: any) => this.setState({ tab: event.key });\r\n  drawerControl = (on: boolean) => this.setState({ drawerVisible: on });\r\n  uploadControl = (on: boolean) => this.setState({ uploadInProgress: on });\r\n\r\n  enzh = (english: string, chinese: string): string =>\r\n    this.props.language === 'en-us' ? english : chinese;\r\n\r\n  zhtab = (english: string): string => {\r\n    switch (english) {\r\n      case \"EV Management\":\r\n        return \"电动汽车分析平台\";\r\n      case \"ESS Management\":\r\n        return \"储能系统分析平台\";\r\n      case \"R&D Management\":\r\n        return \"电池研发测试分析平台\";\r\n      default:\r\n        return \"\";\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"Dashboard\">\r\n        <Content style={{ padding: '0 50px' }}>\r\n          <Breadcrumb style={{ margin: '16px 0' }}>\r\n            <Breadcrumb.Item>{this.enzh('Home', '主页')}</Breadcrumb.Item>\r\n            <Breadcrumb.Item>{this.enzh(this.state.tab, this.zhtab(this.state.tab))}</Breadcrumb.Item>\r\n          </Breadcrumb>\r\n          <Layout className=\"site-layout-background\" style={{ padding: '24px 0' }}>\r\n            <Sider className=\"site-layout-background\" width={220}>\r\n              <Menu\r\n                mode=\"inline\"\r\n                defaultSelectedKeys={['EV Management']}\r\n                onSelect={this.handleSelect}\r\n                style={{ height: \"100%\" }}\r\n              >\r\n                <Menu.Item\r\n                  key=\"EV Management\"\r\n                  icon={<SisternodeOutlined />}\r\n                >\r\n                  {this.enzh(\"EV Management\", \"电动汽车分析平台\")}\r\n                </Menu.Item>\r\n\r\n                <Menu.Item\r\n                  key=\"ESS Management\"\r\n                  icon={<NodeIndexOutlined />}\r\n                >\r\n                  {this.enzh(\"ESS Management\", \"储能系统分析平台\")}\r\n                </Menu.Item>\r\n\r\n                <Menu.Item\r\n                  key=\"R&amp;D Management\"\r\n                  icon={<ExperimentOutlined />}\r\n                >\r\n                  {this.enzh(\"R&D Management\", \"电池研发测试分析平台\")}\r\n                </Menu.Item>\r\n              </Menu>\r\n            </Sider>\r\n\r\n            <Content style={{ padding: '0 24px', minHeight: 280 }}>\r\n              <DashboardMain\r\n                tab={this.state.tab}\r\n                userInfo={this.state.userInfo}\r\n                uploadInProgress={this.state.uploadInProgress}\r\n                drawerControl={this.drawerControl}\r\n                language={this.props.language}\r\n              />\r\n            </Content>\r\n\r\n          </Layout>\r\n        </Content>\r\n        <Footer style={{ textAlign: 'center' }}>{\"Fova Energy ©2020\"}</Footer>\r\n        <UploadSession\r\n          drawerVisible={this.state.drawerVisible}\r\n          uploadInProgress={this.state.uploadInProgress}\r\n          drawerControl={this.drawerControl}\r\n          uploadControl={this.uploadControl}\r\n          tab={this.state.tab}\r\n          language={this.props.language}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Dashboard;\r\n","import React from 'react';\r\nimport {\r\n  Form,\r\n  Input,\r\n  Select,\r\n  Button,\r\n  Upload,\r\n  Modal\r\n} from 'antd';\r\nimport {\r\n  InboxOutlined,\r\n  ExclamationCircleOutlined,\r\n  CloudUploadOutlined\r\n} from \"@ant-design/icons\";\r\n\r\nimport 'styles/uploadPortal.css';\r\n\r\nimport UploadController from 'components/UploadController';\r\n\r\nimport * as APIUtils from 'utils/api-utils';\r\n\r\nconst { Option } = Select;\r\nconst { confirm } = Modal;\r\n\r\ntype PropsType = {\r\n  language: 'en-us' | 'zh-hans';\r\n}\r\n\r\ntype StateType = {\r\n  fileData: File | null;\r\n  uploadName: string;\r\n  serviceType: string;\r\n  uploadInProgress: boolean;\r\n  unfinishedUpload: boolean;\r\n  unfinishedUploadName: string;\r\n}\r\n\r\nclass UploadPortal extends React.Component<PropsType, StateType> {\r\n\r\n  state: StateType;\r\n  formItemLayout: any;\r\n\r\n  constructor(props: PropsType) {\r\n    super(props);\r\n    this.state = {\r\n      fileData: null,\r\n      uploadName: \"\",\r\n      serviceType: \"ev\",\r\n      uploadInProgress: false,\r\n      unfinishedUpload: false,\r\n      unfinishedUploadName: \"\"\r\n    };\r\n\r\n    this.formItemLayout = {\r\n      labelCol: { span: 6 },\r\n      wrapperCol: { span: 14 }\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    APIUtils.get('/api/data/upload/list', { product: \"ev\"})\r\n      .then(response => {\r\n        if (response.code === 'OK') {\r\n          let uploadList: any[] = (response as APIUtils.SuccessResponseDataType).data.items;\r\n          if (uploadList.length !== 0 && uploadList[0].state === 'uploading') {\r\n            this.setState({\r\n              unfinishedUpload: true,\r\n              unfinishedUploadName: (uploadList[0].upload_name)\r\n            });\r\n\r\n            confirm({\r\n              title: this.enzh(\r\n                `Unfinished upload detected: ${this.state.unfinishedUploadName}`,\r\n                `检测到尚未完成的上传: ${this.state.unfinishedUploadName}`\r\n                ),\r\n              icon: <ExclamationCircleOutlined />,\r\n              content: this.enzh(\r\n                \"If you wish to resume the unfinished upload, select the same file and upload again. \",\r\n                \"如果您想要继续未完成的上传，请在您的设备上选择该文件并再次点击上传。\"\r\n                ),\r\n              onOk() {},\r\n              onCancel() {},\r\n              okText: this.enzh(\"OK\", \"确定\"),\r\n              cancelText: this.enzh(\"Cancel\", \"取消\"),\r\n              width: 500\r\n            });\r\n          }\r\n        } else {\r\n          APIUtils.handleError(response.code, this.props.language)\r\n        }\r\n      })\r\n  }\r\n\r\n  /** Controller Functions */\r\n  uploadControl = (on: boolean) => this.setState({ uploadInProgress: on });\r\n  inputUploadName = (e: any) => this.setState({ uploadName: e.target.value });\r\n  selectService = (value: string) => this.setState({ serviceType: value });\r\n  resumeUploadControl = (on: boolean) => this.setState({ unfinishedUpload: on });\r\n  onSubmit = (values: any) => {\r\n    this.setState({\r\n      uploadName: values.uploadName,\r\n      serviceType: values.service,\r\n      uploadInProgress: true\r\n    });\r\n  };\r\n\r\n  loadFile = (e: any) => {\r\n    this.setState({\r\n      fileData: e.file\r\n    });\r\n\r\n    if (Array.isArray(e)) {\r\n      return e;\r\n    }\r\n    return e && e.fileList;\r\n  };\r\n\r\n  enzh = (english: string, chinese: string): string =>\r\n    this.props.language === 'en-us' ? english : chinese;\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"UploadPortal\">\r\n        <Form\r\n          className=\"upload-portal-form\"\r\n          name=\"upload-portal-form\"\r\n          {...this.formItemLayout}\r\n          onFinish={this.onSubmit}\r\n        >\r\n          <Form.Item\r\n            label={this.enzh(\"Upload Name\", \"数据名\")}\r\n            name=\"uploadName\"\r\n            rules={[\r\n              { required: true, message: this.enzh(\"An upload name is required to continue\", \"请输入数据名\") }\r\n            ]}\r\n          >\r\n            <Input onChange={this.inputUploadName} placeholder={this.enzh(\"Custom name for this dataset.\", \"请自定义数据名\")} />\r\n          </Form.Item>\r\n\r\n          <Form.Item\r\n            label={this.enzh(\"Select Service\", \"选择数据类型\")}\r\n            initialValue=\"ev\"\r\n            name=\"service\"\r\n          >\r\n            <Select onChange={this.selectService}>\r\n              <Option value=\"ev\">{this.enzh(\"EV Operation\", \"电动汽车运行数据\")}</Option>\r\n              <Option value=\"ess\">{this.enzh(\"ESS Operation\", \"储能系统分析平台\")}</Option>\r\n              <Option value=\"rd\">{this.enzh(\"Cell Long-term Performance Testing\", \"电芯循环测试数据\")}</Option>\r\n            </Select>\r\n          </Form.Item>\r\n\r\n          <Form.Item\r\n            label={this.enzh(\"Upload File\", \"上传数据\")}\r\n            rules={[\r\n              { required: true, message: this.enzh(\"Please upload dataset to continue. \", \"请添加数据文件\") }\r\n            ]}\r\n          >\r\n            <Form.Item\r\n              name=\"dragger\"\r\n              valuePropName=\"fileList\"\r\n              getValueFromEvent={this.loadFile}\r\n              noStyle\r\n            >\r\n              <Upload.Dragger\r\n                name=\"files\"\r\n                beforeUpload={(file, fileList) => false}\r\n              >\r\n                <p className=\"ant-upload-drag-icon\">\r\n                  <InboxOutlined />\r\n                </p>\r\n                <p className=\"ant-upload-text\">\r\n                  {this.enzh(\"Click or drag file to this area to upload\", \"点击或拖拽文件至此区域\")}\r\n                </p>\r\n              </Upload.Dragger>\r\n            </Form.Item>\r\n          </Form.Item>\r\n\r\n          <Form.Item\r\n            wrapperCol={{\r\n              span: 12,\r\n              offset: 6\r\n            }}\r\n          >\r\n            <Button\r\n              className=\"upload-portal-button\"\r\n              type=\"primary\"\r\n              htmlType=\"submit\"\r\n              icon={<CloudUploadOutlined />}\r\n              disabled={\r\n                this.state.fileData === null ? true : false\r\n              }\r\n              loading={\r\n                this.state.uploadInProgress ? true : false\r\n              }\r\n            >\r\n              { this.state.uploadInProgress ?\r\n                this.enzh(\"Upload In Progress\", \"上传中\") :\r\n                this.enzh(\"Start Upload\", \"开始上传\")\r\n              }\r\n            </Button>\r\n          </Form.Item>\r\n        </Form>\r\n\r\n        { this.state.uploadInProgress ?\r\n          <UploadController\r\n            file={this.state.fileData as File}\r\n            uploadName={this.state.uploadName}\r\n            product={this.state.serviceType}\r\n            uploadControl={this.uploadControl}\r\n            language={this.props.language}\r\n          /> : null\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default UploadPortal;\r\n","import React from 'react';\r\n\r\nimport 'styles/logo.css'\r\n\r\nimport logo from 'assets/logo.svg';\r\n\r\nconst Logo = () => (\r\n  <div className=\"Logo\">\r\n    <div className=\"Logo-icon-box\">\r\n    <img src={logo} className=\"Logo-icon\" alt=\"logo\" />\r\n    </div>\r\n    <span className=\"Logo-title\">FOVA Energy</span>\r\n  </div>\r\n)\r\n\r\nexport default Logo;\r\n","import React from 'react';\r\nimport { Layout, Menu } from 'antd';\r\nimport {\r\n  GlobalOutlined,\r\n  LogoutOutlined\r\n} from '@ant-design/icons';\r\n\r\nimport 'styles/topBar.css';\r\n\r\nimport Logo from 'components/Logo';\r\n\r\nimport * as APIUtils from 'utils/api-utils';\r\n\r\nconst { Header } = Layout;\r\nconst { SubMenu } = Menu;\r\n\r\ntype PropsType = {\r\n  authorized: boolean;\r\n  language: 'en-us' | 'zh-hans';\r\n  handleSignout: () => void;\r\n  switchLanguage: (inputLanguage: PropsType['language']) => void;\r\n}\r\n\r\nclass TopBar extends React.Component<PropsType> {\r\n\r\n  handleSelectLanguage = (event: any) => {\r\n    this.props.switchLanguage(event.key);\r\n  }\r\n\r\n  handleClickLogout = () => {\r\n    APIUtils.post('/api/account/logout')\r\n      .then(response => {\r\n        if (response.code === 'OK') {\r\n          this.props.handleSignout();\r\n        } else {\r\n          APIUtils.handleError(response.code, this.props.language);\r\n        }\r\n      });\r\n  }\r\n\r\n  enzh = (english: string, chinese: string): string =>\r\n    this.props.language === 'en-us' ? english : chinese;\r\n\r\n  render() {\r\n\r\n    const userMenu = (\r\n      <Menu.Item\r\n        key=\"menu-signout\"\r\n        icon={<LogoutOutlined height=\"3em\" />}\r\n        style={{ float: \"right\" }}\r\n        onClick={this.handleClickLogout}\r\n      >\r\n        {this.enzh('Sign Out', '退出登录')}\r\n      </Menu.Item>\r\n    )\r\n\r\n    return (\r\n      <div className=\"TopBar\">\r\n        <Header className=\"header\">\r\n          <Logo />\r\n          <Menu theme=\"dark\" mode=\"horizontal\">\r\n            {this.props.authorized ? userMenu : null}\r\n            <SubMenu\r\n              key=\"menu-language\"\r\n              icon={<GlobalOutlined height=\"3em\" />}\r\n              title={this.enzh('Intl-English', 'Intl-简体中文')}\r\n              style={{ float: \"right\" }}\r\n            >\r\n              <Menu.Item key=\"zh-hans\" onClick={this.handleSelectLanguage}>简体中文</Menu.Item>\r\n              <Menu.Item key=\"en-us\" onClick={this.handleSelectLanguage}>English - US</Menu.Item>\r\n            </SubMenu>\r\n          </Menu>\r\n        </Header>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default TopBar;\r\n","import React from 'react';\r\nimport { Switch, Route, Redirect } from 'react-router';\r\nimport { Layout } from 'antd';\r\n\r\nimport 'styles/app.css';\r\n\r\nimport Signin from 'components/Signin';\r\nimport Dashboard from 'components/Dashboard';\r\nimport UploadPortal from 'components/UploadPortal';\r\nimport TopBar from 'components/TopBar';\r\n\r\nimport * as APIUtils from 'utils/api-utils';\r\n\r\ntype StateType = {\r\n  authorized: boolean;\r\n  language: 'en-us' | 'zh-hans';\r\n}\r\n\r\nclass App extends React.Component<{}, StateType> {\r\n\r\n  state: StateType;\r\n  constructor(props: never) {\r\n    super(props);\r\n    this.state = {\r\n      authorized: false,\r\n      language: 'en-us' as const\r\n    }\r\n\r\n    this.handleSignout = this.handleSignout.bind(this);\r\n    this.switchLanguage = this.switchLanguage.bind(this);\r\n  }\r\n\r\n  /**\r\n   * Check if a user is logged in\r\n   */\r\n  componentDidMount = () => {\r\n    APIUtils.get('/api/account/user/info')\r\n    .then(responseData => {\r\n      if (responseData.code === 'OK') {\r\n        this.setState({\r\n          authorized: true\r\n        });\r\n      }\r\n    })\r\n    .catch(() => {\r\n      this.setState({\r\n        authorized: false\r\n      })\r\n    })\r\n  }\r\n\r\n  handleSignin = () => { this.setState({ authorized: true }); }\r\n  handleSignout = () => { this.setState({ authorized: false }); }\r\n  switchLanguage = (inputLanguage: StateType[\"language\"]) => { this.setState({ language: inputLanguage });}\r\n\r\n  mountSignin = () => {\r\n    return this.state.authorized ?\r\n      // Upload Portal mount flag\r\n      <Redirect to=\"/home\" /> :\r\n      <Signin\r\n        handleSignin={this.handleSignin}\r\n        language={this.state.language}\r\n      />\r\n  }\r\n\r\n  mountDashboard = () => {\r\n    return this.state.authorized ?\r\n    <Dashboard\r\n      language={this.state.language} /> :\r\n    <Redirect to=\"/signin\" />\r\n  }\r\n\r\n  mountUploadPortal = () => {\r\n    return this.state.authorized ?\r\n    <UploadPortal language={this.state.language} /> :\r\n    <Redirect to=\"/signin\" />\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"App\">\r\n        <Layout>\r\n          <TopBar\r\n            authorized={this.state.authorized}\r\n            language={this.state.language}\r\n            handleSignout={this.handleSignout}\r\n            switchLanguage={this.switchLanguage}\r\n          />\r\n        <Switch>\r\n          <Route exact path=\"/\" render={this.mountSignin} />\r\n          <Route path=\"/signin\" render={this.mountSignin} />\r\n          <Route path=\"/home\" render={this.mountDashboard} />\r\n          <Route path=\"/upload-portal\" render={this.mountUploadPortal} />\r\n          <Route render={this.mountSignin} />\r\n        </Switch>\r\n        </Layout>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { BrowserRouter } from 'react-router-dom';\r\n\r\nimport 'styles/index.css';\r\n\r\nimport App from 'components/App';\r\nimport * as serviceWorker from 'serviceWorker';\r\n\r\nReactDOM.render(\r\n  <BrowserRouter>\r\n    <App />\r\n  </BrowserRouter>\r\n  , document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}